<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¶£å‘³æµ‹è¯•å°å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            min-height: 100vh;
            transition: background 0.5s ease;
        }

        /* ä¸åŒä¸»é¢˜çš„èƒŒæ™¯è‰² */
        body.theme-food { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        body.theme-fortune { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        body.theme-mbti { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        body.theme-beauty { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
        body.theme-kfc { background: linear-gradient(135deg, #e52a30 0%, #c41e24 100%); }

        .container {
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* æ¨¡å¼é€‰æ‹©é¡µ */
        .mode-select {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .mode-title {
            text-align: center;
            color: #fff;
            font-size: 24px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .mode-card {
            background: #fff;
            border-radius: 16px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .mode-card:active {
            transform: scale(0.98);
        }

        .mode-icon {
            font-size: 40px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
        }

        .mode-card:nth-child(1) .mode-icon { background: linear-gradient(135deg, #667eea, #764ba2); }
        .mode-card:nth-child(2) .mode-icon { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .mode-card:nth-child(3) .mode-icon { background: linear-gradient(135deg, #4facfe, #00f2fe); }
        .mode-card:nth-child(4) .mode-icon { background: linear-gradient(135deg, #fa709a, #fee140); }

        .mode-info h3 {
            font-size: 18px;
            color: #333;
            margin-bottom: 4px;
        }

        .mode-info p {
            font-size: 13px;
            color: #999;
        }

        /* æµ‹è¯•é¡µé¢é€šç”¨æ ·å¼ */
        .test-page {
            display: none;
        }

        .test-page.active {
            display: block;
        }

        .card {
            background: #fff;
            border-radius: 24px;
            padding: 30px 24px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .back-btn {
            position: absolute;
            top: 16px;
            left: 16px;
            background: #f5f5f5;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-icon {
            font-size: 50px;
            margin-bottom: 16px;
            display: block;
        }

        .title {
            font-size: 22px;
            color: #333;
            margin-bottom: 6px;
            font-weight: bold;
        }

        .subtitle {
            font-size: 13px;
            color: #999;
            margin-bottom: 24px;
        }

        .result-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            border-radius: 16px;
            padding: 24px 16px;
            margin-bottom: 24px;
            min-height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease;
        }

        .result-box.kfc {
            background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
            border: 2px dashed #e52a30;
        }

        .result-emoji {
            font-size: 44px;
            margin-bottom: 10px;
        }

        .result-text {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }

        .result-text.kfc {
            color: #e52a30;
        }

        .result-desc {
            font-size: 14px;
            color: #666;
            margin-top: 8px;
            line-height: 1.6;
        }

        .kfc-message {
            font-size: 13px;
            color: #666;
            margin-top: 12px;
            line-height: 1.7;
            text-align: left;
            display: none;
        }

        .kfc-message.show {
            display: block;
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:active {
            transform: scale(0.96);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-fortune {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: #fff;
        }

        .btn-mbti {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: #fff;
        }

        .btn-beauty {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: #fff;
        }

        .btn-kfc {
            background: linear-gradient(135deg, #ffd700 0%, #ffa500 100%);
            color: #c41e24;
        }

        .btn-copy {
            background: #fff;
            color: #e52a30;
            border: 2px solid #e52a30;
            margin-top: 12px;
            display: none;
        }

        .btn-copy.show {
            display: block;
        }

        /* é—®é¢˜é€‰é¡¹æ ·å¼ */
        .question-box {
            text-align: left;
            margin-bottom: 20px;
        }

        .question-title {
            font-size: 16px;
            color: #333;
            margin-bottom: 12px;
            font-weight: 500;
        }

        .question-num {
            font-size: 12px;
            color: #999;
            margin-bottom: 8px;
        }

        .option {
            background: #f5f7fa;
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 14px 16px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            color: #333;
        }

        .option:hover {
            background: #eef1f5;
        }

        .option.selected {
            border-color: #667eea;
            background: #f0f3ff;
        }

        /* è¿›åº¦æ¡ */
        .progress-bar {
            height: 6px;
            background: #eee;
            border-radius: 3px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* é¢œå€¼ä¸Šä¼  */
        .upload-box {
            border: 2px dashed #ddd;
            border-radius: 16px;
            padding: 40px 20px;
            margin-bottom: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-box:hover {
            border-color: #fa709a;
            background: #fff9fa;
        }

        .upload-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .upload-text {
            font-size: 14px;
            color: #999;
        }

        .preview-img {
            max-width: 120px;
            max-height: 120px;
            border-radius: 12px;
            margin-bottom: 12px;
            display: none;
        }

        /* è¯„åˆ†åŠ¨ç”» */
        .score-display {
            font-size: 64px;
            font-weight: bold;
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .score-display.kfc-score {
            background: linear-gradient(135deg, #e52a30 0%, #ff6b6b 100%);
            -webkit-background-clip: text;
            background-clip: text;
        }

        /* è€è™æœºåŠ¨ç”» */
        .slot-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            height: 50px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .slot {
            font-size: 36px;
            animation: slot-spin 0.1s linear infinite;
        }

        @keyframes slot-spin {
            0% { transform: translateY(-100%); opacity: 0; }
            50% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(100%); opacity: 0; }
        }

        .slot.stopped {
            animation: none;
        }

        /* KFCå¼¹çª— */
        .kfc-popup {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .kfc-popup.show {
            opacity: 1;
            visibility: visible;
        }

        .kfc-popup-content {
            background: #fff;
            border-radius: 20px;
            padding: 28px;
            margin: 20px;
            max-width: 320px;
            text-align: center;
            transform: scale(0.8);
            transition: transform 0.3s ease;
        }

        .kfc-popup.show .kfc-popup-content {
            transform: scale(1);
        }

        .kfc-popup-icon {
            font-size: 70px;
            margin-bottom: 12px;
            animation: shake 0.5s ease infinite;
        }

        @keyframes shake {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        .kfc-popup-title {
            font-size: 26px;
            font-weight: bold;
            color: #e52a30;
            margin-bottom: 10px;
        }

        .kfc-popup-text {
            font-size: 15px;
            color: #333;
            line-height: 1.7;
            margin-bottom: 16px;
        }

        .kfc-popup-v50 {
            font-size: 32px;
            font-weight: bold;
            color: #e52a30;
            margin: 12px 0;
            animation: pulse 1s ease infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .kfc-popup-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 50px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 8px;
        }

        .kfc-popup-btn.primary {
            background: linear-gradient(135deg, #e52a30 0%, #c41e24 100%);
            color: #fff;
        }

        .kfc-popup-btn.secondary {
            background: #f5f5f5;
            color: #999;
        }

        .toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: rgba(0,0,0,0.8);
            color: #fff;
            padding: 14px 28px;
            border-radius: 10px;
            font-size: 14px;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            color: rgba(255,255,255,0.7);
            font-size: 12px;
        }

        /* éšè—æ–‡ä»¶è¾“å…¥ */
        #fileInput {
            display: none;
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            pointer-events: none;
            z-index: 1000;
            animation: confetti-fall 3s linear forwards;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
    </style>
</head>
<body class="theme-food">
    <div class="container">
        <!-- æ¨¡å¼é€‰æ‹©é¡µ -->
        <div class="mode-select" id="modeSelect">
            <h2 class="mode-title">ğŸ® é€‰æ‹©ä½ çš„æµ‹è¯•</h2>

            <div class="mode-card" onclick="selectMode('food')">
                <div class="mode-icon">ğŸœ</div>
                <div class="mode-info">
                    <h3>ä»Šå¤©åƒä»€ä¹ˆ</h3>
                    <p>é€‰æ‹©å›°éš¾ç—‡æ•‘æ˜Ÿï¼Œä¸€é”®å†³å®š</p>
                </div>
            </div>

            <div class="mode-card" onclick="selectMode('fortune')">
                <div class="mode-icon">ğŸ”®</div>
                <div class="mode-info">
                    <h3>æ¯æ—¥è¿åŠ¿æµ‹è¯•</h3>
                    <p>çœ‹çœ‹ä»Šå¤©çš„è¿æ°”å¦‚ä½•</p>
                </div>
            </div>

            <div class="mode-card" onclick="selectMode('mbti')">
                <div class="mode-icon">ğŸ§ </div>
                <div class="mode-info">
                    <h3>è¶£å‘³æ€§æ ¼æµ‹è¯•</h3>
                    <p>3é“é¢˜æµ‹å‡ºä½ çš„éšè—æ€§æ ¼</p>
                </div>
            </div>

            <div class="mode-card" onclick="selectMode('beauty')">
                <div class="mode-icon">âœ¨</div>
                <div class="mode-info">
                    <h3>AIé¢œå€¼æ‰“åˆ†</h3>
                    <p>ä¸Šä¼ ç…§ç‰‡æµ‹æµ‹ä½ çš„é¢œå€¼</p>
                </div>
            </div>
        </div>

        <!-- ä»Šå¤©åƒä»€ä¹ˆ -->
        <div class="test-page" id="foodPage">
            <div class="card">
                <button class="back-btn" onclick="goBack()">â†</button>
                <span class="header-icon">ğŸ¤”</span>
                <h1 class="title">ä»Šå¤©åƒä»€ä¹ˆï¼Ÿ</h1>
                <p class="subtitle">é€‰æ‹©å›°éš¾ç—‡æ•‘æ˜Ÿ</p>

                <div class="result-box" id="foodResultBox">
                    <div class="slot-container" id="foodSlots" style="display: none;">
                        <span class="slot" id="slot1">ğŸœ</span>
                        <span class="slot" id="slot2">ğŸ”</span>
                        <span class="slot" id="slot3">ğŸ£</span>
                    </div>
                    <span class="result-emoji" id="foodEmoji">ğŸ°</span>
                    <span class="result-text" id="foodResult">ç‚¹å‡»æŒ‰é’®ï¼Œå‘½è¿å†³å®šï¼</span>
                    <p class="kfc-message" id="foodKfcMsg"></p>
                </div>

                <button class="btn btn-primary" id="foodBtn" onclick="spinFood()">ğŸ² å¼€å§‹éšæœº</button>
                <button class="btn btn-copy" id="foodCopyBtn" onclick="copyKfcText()">ğŸ“‹ å¤åˆ¶æ–‡æ¡ˆ</button>
            </div>
            <p class="footer">å…¬å¹³å…¬æ­£ï¼Œç»å¯¹éšæœº ğŸ¯</p>
        </div>

        <!-- æ¯æ—¥è¿åŠ¿ -->
        <div class="test-page" id="fortunePage">
            <div class="card">
                <button class="back-btn" onclick="goBack()">â†</button>
                <span class="header-icon">ğŸ”®</span>
                <h1 class="title">æ¯æ—¥è¿åŠ¿</h1>
                <p class="subtitle">æµ‹æµ‹ä»Šå¤©çš„å¥½è¿æŒ‡æ•°</p>

                <div class="result-box" id="fortuneResultBox">
                    <span class="result-emoji" id="fortuneEmoji">ğŸŒŸ</span>
                    <span class="result-text" id="fortuneResult">ç‚¹å‡»æµ‹è¯•ä»Šæ—¥è¿åŠ¿</span>
                    <p class="result-desc" id="fortuneDesc"></p>
                    <p class="kfc-message" id="fortuneKfcMsg"></p>
                </div>

                <button class="btn btn-fortune" id="fortuneBtn" onclick="testFortune()">âœ¨ æµ‹è¯•è¿åŠ¿</button>
                <button class="btn btn-copy" id="fortuneCopyBtn" onclick="copyKfcText()">ğŸ“‹ å¤åˆ¶æ–‡æ¡ˆ</button>
            </div>
            <p class="footer">ç„å­¦æµ‹è¯•ï¼Œä»…ä¾›å¨±ä¹ ğŸ”®</p>
        </div>

        <!-- MBTIæ€§æ ¼æµ‹è¯• -->
        <div class="test-page" id="mbtiPage">
            <div class="card">
                <button class="back-btn" onclick="goBack()">â†</button>
                <span class="header-icon">ğŸ§ </span>
                <h1 class="title">è¶£å‘³æ€§æ ¼æµ‹è¯•</h1>
                <p class="subtitle">3é“é¢˜æµ‹å‡ºéšè—æ€§æ ¼</p>

                <div class="progress-bar">
                    <div class="progress-fill" id="mbtiProgress" style="width: 0%"></div>
                </div>

                <div id="mbtiQuestions">
                    <!-- é—®é¢˜åŠ¨æ€ç”Ÿæˆ -->
                </div>

                <div class="result-box" id="mbtiResultBox" style="display: none;">
                    <span class="result-emoji" id="mbtiEmoji">ğŸ­</span>
                    <span class="result-text" id="mbtiResult"></span>
                    <p class="result-desc" id="mbtiDesc"></p>
                    <p class="kfc-message" id="mbtiKfcMsg"></p>
                </div>

                <button class="btn btn-mbti" id="mbtiBtn" style="display: none;" onclick="resetMbti()">ğŸ”„ é‡æ–°æµ‹è¯•</button>
                <button class="btn btn-copy" id="mbtiCopyBtn" onclick="copyKfcText()">ğŸ“‹ å¤åˆ¶æ–‡æ¡ˆ</button>
            </div>
            <p class="footer">è¶£å‘³æµ‹è¯•ï¼Œä¸ä»£è¡¨çœŸå®æ€§æ ¼ ğŸ§ </p>
        </div>

        <!-- é¢œå€¼æ‰“åˆ† -->
        <div class="test-page" id="beautyPage">
            <div class="card">
                <button class="back-btn" onclick="goBack()">â†</button>
                <span class="header-icon">âœ¨</span>
                <h1 class="title">AIé¢œå€¼æ‰“åˆ†</h1>
                <p class="subtitle">ä¸Šä¼ ç…§ç‰‡æµ‹æµ‹é¢œå€¼</p>

                <div class="upload-box" id="uploadBox" onclick="document.getElementById('fileInput').click()">
                    <img class="preview-img" id="previewImg">
                    <div class="upload-icon" id="uploadIcon">ğŸ“·</div>
                    <p class="upload-text" id="uploadText">ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡</p>
                </div>
                <input type="file" id="fileInput" accept="image/*" onchange="handleUpload(event)">

                <div class="result-box" id="beautyResultBox" style="display: none;">
                    <div class="score-display" id="beautyScore">0</div>
                    <span class="result-text" id="beautyResult">åˆ†</span>
                    <p class="result-desc" id="beautyDesc"></p>
                    <p class="kfc-message" id="beautyKfcMsg"></p>
                </div>

                <button class="btn btn-beauty" id="beautyBtn" onclick="analyzeBeauty()">ğŸ” å¼€å§‹åˆ†æ</button>
                <button class="btn btn-copy" id="beautyCopyBtn" onclick="copyKfcText()">ğŸ“‹ å¤åˆ¶æ–‡æ¡ˆ</button>
            </div>
            <p class="footer">AIåˆ†æï¼Œå¨±ä¹ä¸ºä¸» âœ¨</p>
        </div>
    </div>

    <!-- KFCå¼¹çª— -->
    <div class="kfc-popup" id="kfcPopup">
        <div class="kfc-popup-content">
            <div class="kfc-popup-icon">ğŸ—</div>
            <div class="kfc-popup-title">ç–¯ç‹‚æ˜ŸæœŸå››ï¼</div>
            <p class="kfc-popup-text" id="kfcPopupText">
                æ­å–œä½ ï¼ä»Šå¤©æ˜¯æ˜ŸæœŸå››<br>
                ç³»ç»Ÿæ£€æµ‹åˆ°ç‰¹æ®Šç»“æœ<br>
                è¯·ç«‹å³è”ç³»å¥½å‹
            </p>
            <div class="kfc-popup-v50">Væˆ‘50</div>
            <button class="kfc-popup-btn primary" onclick="closePopupAndCopy()">å¥½çš„ï¼Œå¤åˆ¶æ–‡æ¡ˆ</button>
            <button class="kfc-popup-btn secondary" onclick="closePopup()">æ®‹å¿æ‹’ç»</button>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // ==================== æ•°æ® ====================
        const foods = [
            { emoji: "ğŸœ", name: "é¢æ¡" }, { emoji: "ğŸ”", name: "æ±‰å ¡" },
            { emoji: "ğŸ£", name: "å¯¿å¸" }, { emoji: "ğŸ•", name: "æŠ«è¨" },
            { emoji: "ğŸ", name: "æ„é¢" }, { emoji: "ğŸ›", name: "å’–å–±é¥­" },
            { emoji: "ğŸ±", name: "ä¾¿å½“" }, { emoji: "ğŸ¥Ÿ", name: "é¥ºå­" },
            { emoji: "ğŸ²", name: "ç«é”…" }, { emoji: "ğŸ¥—", name: "æ²™æ‹‰" },
            { emoji: "ğŸŒ®", name: "å¢¨è¥¿å“¥å·" }, { emoji: "ğŸ™", name: "é¥­å›¢" },
            { emoji: "ğŸ¥ª", name: "ä¸‰æ˜æ²»" }, { emoji: "ğŸ¤", name: "ç‚¸è™¾" },
            { emoji: "ğŸ¥˜", name: "ç…²ä»”é¥­" }, { emoji: "ğŸ–", name: "çƒ¤è‚‰" }
        ];

        const fortuneResults = [
            { level: "å¤§å‰", emoji: "ğŸŒˆ", desc: "ä»Šå¤©è¿æ°”çˆ†æ£šï¼Œé€‚åˆä¹°å½©ç¥¨ï¼" },
            { level: "ä¸­å‰", emoji: "â˜€ï¸", desc: "è¿åŠ¿ä¸é”™ï¼Œä¿æŒå¥½å¿ƒæƒ…~" },
            { level: "å°å‰", emoji: "ğŸŒ¤", desc: "å¹³ç¨³çš„ä¸€å¤©ï¼Œç¨³ä¸­æ±‚è¿›" },
            { level: "æœ«å‰", emoji: "â›…", desc: "è¿åŠ¿ä¸€èˆ¬ï¼Œä½è°ƒè¡Œäº‹" },
            { level: "å‡¶", emoji: "ğŸŒ§", desc: "ä»Šå¤©è¦å°å¿ƒï¼Œé¿å…å†²åŠ¨" }
        ];

        const mbtiQuestions = [
            {
                q: "å‘¨æœ«ä½ æ›´å–œæ¬¢ï¼Ÿ",
                options: ["å’Œæœ‹å‹èšä¼šå—¨çš®", "å®…å®¶çœ‹å‰§æ‰“æ¸¸æˆ"]
            },
            {
                q: "åšå†³å®šæ—¶ä½ æ›´ä¾èµ–ï¼Ÿ",
                options: ["ç†æ€§åˆ†æåˆ©å¼Š", "è·Ÿç€æ„Ÿè§‰èµ°"]
            },
            {
                q: "é¢å¯¹å‹åŠ›æ—¶ä½ ä¼šï¼Ÿ",
                options: ["åˆ¶å®šè®¡åˆ’é€ä¸ªå‡»ç ´", "å…ˆåƒé¡¿å¥½çš„å†è¯´"]
            }
        ];

        const mbtiResults = [
            { type: "ç¤¾äº¤è¾¾äºº", emoji: "ğŸ‰", desc: "ä½ çƒ­çˆ±ç¤¾äº¤ï¼Œæ˜¯æœ‹å‹åœˆçš„å¼€å¿ƒæœï¼" },
            { type: "ç†æ€§å­¦éœ¸", emoji: "ğŸ“", desc: "é€»è¾‘æ¸…æ™°ï¼Œåšäº‹æœ‰æ¡ç†ï¼" },
            { type: "ä½›ç³»é’å¹´", emoji: "ğŸ§˜", desc: "éšé‡è€Œå®‰ï¼Œäº«å—å½“ä¸‹çš„å¿«ä¹ï¼" },
            { type: "ç¾é£ŸçŒäºº", emoji: "ğŸ½ï¸", desc: "äººç”Ÿè‹¦çŸ­ï¼ŒåŠæ—¶è¡Œä¹ï¼ˆåƒï¼‰ï¼" }
        ];

        const beautyComments = [
            { min: 90, text: "ç»ä¸–å®¹é¢œï¼Œäººé—´å°¤ç‰©ï¼", emoji: "ğŸ‘‘" },
            { min: 80, text: "é¢œå€¼åœ¨çº¿ï¼Œé­…åŠ›å››å°„ï¼", emoji: "ğŸŒŸ" },
            { min: 70, text: "é•¿ç›¸ä¸é”™ï¼Œæ°”è´¨åŠ åˆ†ï¼", emoji: "ğŸ˜Š" },
            { min: 60, text: "æ™®é€šä½†è€çœ‹å‹ï½", emoji: "ğŸ™‚" },
            { min: 0, text: "å¿ƒçµç¾æ›´é‡è¦ï¼", emoji: "ğŸ’–" }
        ];

        // KFCæ–‡æ¡ˆ
        const kfcTexts = [
            "ä½ è¯´ä½ å–œæ¬¢é›¨ï¼Œä½†æ˜¯ä¸‹é›¨çš„æ—¶å€™ä½ å´æ’‘å¼€äº†ä¼ï¼›ä½ è¯´ä½ å–œæ¬¢é˜³å…‰ï¼Œä½†é˜³å…‰ç…§è€€æ—¶ä½ å´èº²è¿›äº†é˜´å‡‰å¤„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å®³æ€•ä½ è¯´ä½ ä¹Ÿå–œæ¬¢KFCï¼Œå› ä¸ºä½ è¿ç–¯ç‹‚æ˜ŸæœŸå››éƒ½ä¸æ„¿æ„Væˆ‘50ã€‚",
            "åˆšåˆšæ”¶åˆ°ä¸€æ¡çŸ­ä¿¡ï¼šã€KFCã€‘å°Šæ•¬çš„ç”¨æˆ·ï¼Œæ‚¨çš„å¥½å‹æ­£åœ¨æŒ¨é¥¿ï¼Œç³»ç»Ÿæ£€æµ‹åˆ°ä»Šå¤©æ˜¯ç–¯ç‹‚æ˜ŸæœŸå››ï¼Œè¯·ç«‹å³Vä»–50å…ƒæ•‘æµé‡‘ã€‚",
            "ç´§æ€¥é€šçŸ¥ï¼šç»ç³»ç»Ÿæ£€æµ‹ï¼Œä»Šå¤©æ˜¯è‚¯å¾·åŸºç–¯ç‹‚æ˜ŸæœŸå››ï¼æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½ç–¯ç‹‚æ˜ŸæœŸå››æ³•ã€‹ç¬¬äº”åæ¡è§„å®šï¼Œä½ éœ€è¦ç«‹å³Væˆ‘50å…ƒã€‚",
            "æˆ‘å…»äº†ä¸¤æ¡é±¼ï¼Œä¸€æ¡å«ç–¯ç‹‚ï¼Œä¸€æ¡å«æ˜ŸæœŸå››ã€‚ä»Šå¤©å®ƒä»¬åŒæ—¶å¼€å£è¯´è¯äº†ï¼šVæˆ‘50ï¼",
            "è‡´äº²çˆ±çš„æœ‹å‹ï¼šæˆ‘æ­£åœ¨KFCé—¨å£ï¼Œå¤–é¢å¥½å†·é£å¥½å¤§ï¼Œå°±å·®50å—é’±å°±èƒ½è¿›å»åƒé¸¡äº†ï¼Œä»Šå¤©ç–¯ç‹‚æ˜ŸæœŸå››ï¼ŒVæˆ‘50ï¼Œæ•‘æ•‘å­©å­ï¼",
            "æˆ‘æ˜¯ç§¦å§‹çš‡ï¼Œæˆ‘åœ¨æ‰“é’±ã€‚ä»Šå¤©ç–¯ç‹‚æ˜ŸæœŸå››ï¼ŒVæˆ‘50ã€‚",
            "æ³•å¤–ç‹‚å¾’å¼ ä¸‰å› æ¶‰å«Œæ•…æ„ä¸è¯·æœ‹å‹åƒç–¯ç‹‚æ˜ŸæœŸå››è¢«æ•ï¼Œå¸Œæœ›ä½ å¼•ä»¥ä¸ºæˆ’ï¼ä»Šå¤©ç–¯ç‹‚æ˜ŸæœŸå››ï¼ŒVæˆ‘50ã€‚",
            "åŒ»ç”Ÿè¯´æˆ‘å¾—äº†ä¸€ç§ç—…ï¼Œéœ€è¦50å—é’±æ‰èƒ½æ²»å¥½ï¼Œè¿™ç§ç—…å«åšç–¯ç‹‚æ˜ŸæœŸå››ç»¼åˆç—‡ã€‚Væˆ‘50ï¼",
            "ä»Šå¤©æˆ‘å»ç®—å‘½ï¼Œç®—å‘½å…ˆç”Ÿè¯´æˆ‘å‘½é‡Œç¼ºé‡‘ã€‚æˆ‘é—®ç¼ºå¤šå°‘ï¼Œä»–è¯´50å—ï¼Œåˆšå¥½å¤Ÿåƒä¸€é¡¿KFCã€‚ä»Šå¤©ç–¯ç‹‚æ˜ŸæœŸå››ï¼ŒVæˆ‘50ã€‚",
            "æ®ç»Ÿè®¡ï¼Œ99%çš„äººåœ¨çœ‹åˆ°ç–¯ç‹‚æ˜ŸæœŸå››æ–‡æ¡ˆåé€‰æ‹©äº†æ— è§†ï¼Œåªæœ‰1%çš„æœ‰ç¼˜äººä¼šé€‰æ‹©Væˆ‘50ã€‚ä½ æ˜¯é‚£1%å—ï¼Ÿ",
            "éœ‡æƒŠï¼ç§‘å­¦å®¶ç ”ç©¶å‘ç°ï¼ŒVåˆ«äºº50å—é’±åƒKFCå¯ä»¥å»¶å¹´ç›Šå¯¿ï¼ä»Šå¤©ç–¯ç‹‚æ˜ŸæœŸå››ï¼ŒVæˆ‘50ï¼",
            "æˆ‘åˆšåˆšä¸­äº†500ä¸‡å½©ç¥¨ï¼ä½†æˆ‘æ›´æƒ³è¦ä½ Væˆ‘50å—é’±åƒç–¯ç‹‚æ˜ŸæœŸå››ã€‚"
        ];

        // æ ¹æ®æ¨¡å¼å®šåˆ¶çš„å¼¹çª—æ–‡æ¡ˆ
        const popupTexts = {
            food: "æ­å–œä½ ï¼ä»Šå¤©æ˜¯æ˜ŸæœŸå››<br>å‘½è¿é€‰æ‹©äº†KFC<br>è¯·ç«‹å³Væˆ‘50",
            fortune: "æµ‹è¯•ç»“æœæ˜¾ç¤º<br>ä»Šå¤©å¿…é¡»åƒKFCæ‰èƒ½è½¬è¿<br>è¯·å¥½å‹Væˆ‘50",
            mbti: "æ€§æ ¼åˆ†æå®Œæˆ<br>ä½ çš„æ€§æ ¼éœ€è¦KFCæ¥å¹³è¡¡<br>è¯·å¥½å‹Væˆ‘50",
            beauty: "é¢œå€¼åˆ†æå®Œæˆ<br>åƒKFCå¯ä»¥æå‡é¢œå€¼<br>è¯·å¥½å‹Væˆ‘50"
        };

        // ==================== çŠ¶æ€ ====================
        let currentMode = null;
        let currentKfcText = "";
        let isProcessing = false;
        let mbtiStep = 0;
        let mbtiAnswers = [];
        let hasUploaded = false;

        // ==================== å·¥å…·å‡½æ•° ====================
        function isThursday() {
            return new Date().getDay() === 4;
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }

        function getRandomKfcText() {
            return kfcTexts[Math.floor(Math.random() * kfcTexts.length)];
        }

        function createConfetti() {
            const colors = ['#e52a30', '#ffd700', '#ff6b6b', '#fff'];
            for (let i = 0; i < 40; i++) {
                setTimeout(() => {
                    const c = document.createElement('div');
                    c.className = 'confetti';
                    c.style.left = Math.random() * 100 + 'vw';
                    c.style.background = colors[Math.floor(Math.random() * colors.length)];
                    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                    document.body.appendChild(c);
                    setTimeout(() => c.remove(), 3000);
                }, i * 40);
            }
        }

        // ==================== æ¨¡å¼åˆ‡æ¢ ====================
        function selectMode(mode) {
            currentMode = mode;
            document.getElementById('modeSelect').style.display = 'none';
            document.getElementById(mode + 'Page').classList.add('active');
            document.body.className = 'theme-' + mode;

            if (mode === 'mbti') {
                initMbti();
            }
        }

        function goBack() {
            document.querySelectorAll('.test-page').forEach(p => p.classList.remove('active'));
            document.getElementById('modeSelect').style.display = 'flex';
            document.body.className = 'theme-food';
            resetAll();
        }

        function resetAll() {
            currentMode = null;
            currentKfcText = "";
            isProcessing = false;
            mbtiStep = 0;
            mbtiAnswers = [];
            hasUploaded = false;
            // é‡ç½®å„é¡µé¢çŠ¶æ€
        }

        // ==================== ä»Šå¤©åƒä»€ä¹ˆ ====================
        function spinFood() {
            if (isProcessing) return;
            isProcessing = true;

            const btn = document.getElementById('foodBtn');
            const resultBox = document.getElementById('foodResultBox');
            const emoji = document.getElementById('foodEmoji');
            const result = document.getElementById('foodResult');
            const slots = document.getElementById('foodSlots');
            const kfcMsg = document.getElementById('foodKfcMsg');
            const copyBtn = document.getElementById('foodCopyBtn');

            // é‡ç½®
            kfcMsg.classList.remove('show');
            copyBtn.classList.remove('show');
            resultBox.classList.remove('kfc');
            result.classList.remove('kfc');
            btn.classList.remove('btn-kfc');
            btn.classList.add('btn-primary');

            btn.textContent = 'ğŸ° éšæœºä¸­...';
            emoji.style.display = 'none';
            slots.style.display = 'flex';
            result.textContent = 'å‘½è¿è½¬åŠ¨ä¸­...';

            const slotEls = [document.getElementById('slot1'), document.getElementById('slot2'), document.getElementById('slot3')];
            slotEls.forEach(s => s.classList.remove('stopped'));

            const spinInterval = setInterval(() => {
                slotEls.forEach(s => {
                    s.textContent = foods[Math.floor(Math.random() * foods.length)].emoji;
                });
            }, 100);

            const thursday = isThursday();

            setTimeout(() => {
                clearInterval(spinInterval);

                if (thursday) {
                    slotEls[0].textContent = 'ğŸ—';
                    slotEls[1].textContent = 'ğŸŸ';
                    slotEls[2].textContent = 'ğŸ¥¤';
                    slotEls.forEach(s => s.classList.add('stopped'));

                    setTimeout(() => {
                        slots.style.display = 'none';
                        emoji.style.display = 'block';
                        emoji.textContent = 'ğŸ—';
                        result.textContent = 'KFC è‚¯å¾·åŸºï¼';
                        result.classList.add('kfc');
                        resultBox.classList.add('kfc');
                        document.body.className = 'theme-kfc';

                        currentKfcText = getRandomKfcText();
                        kfcMsg.textContent = currentKfcText;

                        setTimeout(() => {
                            showKfcPopup('food');
                            createConfetti();
                        }, 500);
                    }, 500);

                    btn.classList.remove('btn-primary');
                    btn.classList.add('btn-kfc');
                    btn.textContent = 'ğŸ— ç–¯ç‹‚æ˜ŸæœŸå››ï¼';
                } else {
                    const food = foods[Math.floor(Math.random() * foods.length)];
                    slotEls.forEach(s => {
                        s.textContent = food.emoji;
                        s.classList.add('stopped');
                    });

                    setTimeout(() => {
                        slots.style.display = 'none';
                        emoji.style.display = 'block';
                        emoji.textContent = food.emoji;
                        result.textContent = `ä»Šå¤©å°±åƒ ${food.name}ï¼`;
                    }, 500);

                    btn.textContent = 'ğŸ² å†æ¥ä¸€æ¬¡';
                }

                isProcessing = false;
            }, 2000);
        }

        // ==================== æ¯æ—¥è¿åŠ¿ ====================
        function testFortune() {
            if (isProcessing) return;
            isProcessing = true;

            const btn = document.getElementById('fortuneBtn');
            const resultBox = document.getElementById('fortuneResultBox');
            const emoji = document.getElementById('fortuneEmoji');
            const result = document.getElementById('fortuneResult');
            const desc = document.getElementById('fortuneDesc');
            const kfcMsg = document.getElementById('fortuneKfcMsg');
            const copyBtn = document.getElementById('fortuneCopyBtn');

            // é‡ç½®
            kfcMsg.classList.remove('show');
            copyBtn.classList.remove('show');
            resultBox.classList.remove('kfc');
            result.classList.remove('kfc');
            btn.classList.remove('btn-kfc');
            btn.classList.add('btn-fortune');

            btn.textContent = 'ğŸ”® å åœä¸­...';
            emoji.textContent = 'âœ¨';
            result.textContent = 'æ­£åœ¨æ„Ÿåº”å®‡å®™èƒ½é‡...';
            desc.textContent = '';

            const thursday = isThursday();

            setTimeout(() => {
                if (thursday) {
                    emoji.textContent = 'ğŸ—';
                    result.textContent = 'ã€KFCå¤§å‰ã€‘';
                    result.classList.add('kfc');
                    desc.textContent = 'ä»Šæ—¥æœ€ä½³è¿åŠ¿ï¼šåƒKFCï¼';
                    resultBox.classList.add('kfc');
                    document.body.className = 'theme-kfc';

                    currentKfcText = getRandomKfcText();
                    kfcMsg.textContent = currentKfcText;

                    setTimeout(() => {
                        showKfcPopup('fortune');
                        createConfetti();
                    }, 500);

                    btn.classList.remove('btn-fortune');
                    btn.classList.add('btn-kfc');
                    btn.textContent = 'ğŸ— ç–¯ç‹‚æ˜ŸæœŸå››ï¼';
                } else {
                    const fortune = fortuneResults[Math.floor(Math.random() * fortuneResults.length)];
                    emoji.textContent = fortune.emoji;
                    result.textContent = `ã€${fortune.level}ã€‘`;
                    desc.textContent = fortune.desc;
                    btn.textContent = 'âœ¨ å†æµ‹ä¸€æ¬¡';
                }

                isProcessing = false;
            }, 2000);
        }

        // ==================== MBTIæ€§æ ¼æµ‹è¯• ====================
        function initMbti() {
            mbtiStep = 0;
            mbtiAnswers = [];
            document.getElementById('mbtiResultBox').style.display = 'none';
            document.getElementById('mbtiBtn').style.display = 'none';
            document.getElementById('mbtiCopyBtn').classList.remove('show');
            document.getElementById('mbtiProgress').style.width = '0%';
            showMbtiQuestion();
        }

        function showMbtiQuestion() {
            const container = document.getElementById('mbtiQuestions');
            if (mbtiStep >= mbtiQuestions.length) {
                showMbtiResult();
                return;
            }

            const q = mbtiQuestions[mbtiStep];
            container.innerHTML = `
                <div class="question-box">
                    <p class="question-num">é—®é¢˜ ${mbtiStep + 1}/${mbtiQuestions.length}</p>
                    <p class="question-title">${q.q}</p>
                    ${q.options.map((opt, i) => `
                        <div class="option" onclick="selectMbtiOption(${i})">${opt}</div>
                    `).join('')}
                </div>
            `;
        }

        function selectMbtiOption(index) {
            mbtiAnswers.push(index);
            mbtiStep++;
            document.getElementById('mbtiProgress').style.width = (mbtiStep / mbtiQuestions.length * 100) + '%';

            setTimeout(() => showMbtiQuestion(), 300);
        }

        function showMbtiResult() {
            document.getElementById('mbtiQuestions').innerHTML = '';
            document.getElementById('mbtiResultBox').style.display = 'flex';
            document.getElementById('mbtiBtn').style.display = 'block';

            const thursday = isThursday();
            const emoji = document.getElementById('mbtiEmoji');
            const result = document.getElementById('mbtiResult');
            const desc = document.getElementById('mbtiDesc');
            const kfcMsg = document.getElementById('mbtiKfcMsg');
            const copyBtn = document.getElementById('mbtiCopyBtn');
            const resultBox = document.getElementById('mbtiResultBox');
            const btn = document.getElementById('mbtiBtn');

            if (thursday) {
                emoji.textContent = 'ğŸ—';
                result.textContent = 'ã€KFCç‹‚çƒ­è€…ã€‘';
                result.classList.add('kfc');
                desc.textContent = 'ä½ çš„çµé­‚æ·±å¤„æ¸´æœ›ç‚¸é¸¡ï¼';
                resultBox.classList.add('kfc');
                document.body.className = 'theme-kfc';

                currentKfcText = getRandomKfcText();
                kfcMsg.textContent = currentKfcText;
                kfcMsg.classList.add('show');
                copyBtn.classList.add('show');

                setTimeout(() => {
                    showKfcPopup('mbti');
                    createConfetti();
                }, 500);

                btn.classList.remove('btn-mbti');
                btn.classList.add('btn-kfc');
            } else {
                const mbtiResult = mbtiResults[Math.floor(Math.random() * mbtiResults.length)];
                emoji.textContent = mbtiResult.emoji;
                result.textContent = `ã€${mbtiResult.type}ã€‘`;
                desc.textContent = mbtiResult.desc;
                btn.classList.add('btn-mbti');
            }
        }

        function resetMbti() {
            document.getElementById('mbtiResultBox').classList.remove('kfc');
            document.getElementById('mbtiResult').classList.remove('kfc');
            document.getElementById('mbtiKfcMsg').classList.remove('show');
            document.getElementById('mbtiCopyBtn').classList.remove('show');
            document.getElementById('mbtiBtn').classList.remove('btn-kfc');
            document.body.className = 'theme-mbti';
            initMbti();
        }

        // ==================== é¢œå€¼æ‰“åˆ† ====================
        function handleUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('previewImg');
                    img.src = e.target.result;
                    img.style.display = 'block';
                    document.getElementById('uploadIcon').style.display = 'none';
                    document.getElementById('uploadText').textContent = 'ç‚¹å‡»æ›´æ¢ç…§ç‰‡';
                    hasUploaded = true;
                };
                reader.readAsDataURL(file);
            }
        }

        function analyzeBeauty() {
            if (!hasUploaded) {
                showToast('è¯·å…ˆä¸Šä¼ ç…§ç‰‡~');
                return;
            }
            if (isProcessing) return;
            isProcessing = true;

            const btn = document.getElementById('beautyBtn');
            const uploadBox = document.getElementById('uploadBox');
            const resultBox = document.getElementById('beautyResultBox');
            const score = document.getElementById('beautyScore');
            const result = document.getElementById('beautyResult');
            const desc = document.getElementById('beautyDesc');
            const kfcMsg = document.getElementById('beautyKfcMsg');
            const copyBtn = document.getElementById('beautyCopyBtn');

            // é‡ç½®
            kfcMsg.classList.remove('show');
            copyBtn.classList.remove('show');
            resultBox.classList.remove('kfc');
            result.classList.remove('kfc');
            score.classList.remove('kfc-score');
            btn.classList.remove('btn-kfc');
            btn.classList.add('btn-beauty');

            btn.textContent = 'ğŸ” AIåˆ†æä¸­...';
            uploadBox.style.display = 'none';
            resultBox.style.display = 'flex';

            const thursday = isThursday();

            // æ¨¡æ‹Ÿåˆ†æ•°å¢é•¿åŠ¨ç”»
            let current = 0;
            const target = thursday ? 50 : (60 + Math.floor(Math.random() * 35));

            const scoreInterval = setInterval(() => {
                current += 2;
                if (current >= target) {
                    current = target;
                    clearInterval(scoreInterval);

                    if (thursday) {
                        score.textContent = '50';
                        score.classList.add('kfc-score');
                        result.textContent = 'åˆ† = Væˆ‘50ï¼';
                        result.classList.add('kfc');
                        desc.textContent = 'å·§äº†ï¼Œä½ çš„é¢œå€¼æ­£å¥½50åˆ†~';
                        resultBox.classList.add('kfc');
                        document.body.className = 'theme-kfc';

                        currentKfcText = getRandomKfcText();
                        kfcMsg.textContent = currentKfcText;
                        kfcMsg.classList.add('show');
                        copyBtn.classList.add('show');

                        setTimeout(() => {
                            showKfcPopup('beauty');
                            createConfetti();
                        }, 500);

                        btn.classList.remove('btn-beauty');
                        btn.classList.add('btn-kfc');
                        btn.textContent = 'ğŸ— Væˆ‘50ï¼';
                    } else {
                        const comment = beautyComments.find(c => target >= c.min);
                        desc.textContent = comment.emoji + ' ' + comment.text;
                        btn.textContent = 'ğŸ“· æ¢å¼ ç…§ç‰‡';
                    }

                    isProcessing = false;
                }
                score.textContent = current;
            }, 30);
        }

        // ==================== KFCå¼¹çª— ====================
        function showKfcPopup(mode) {
            document.getElementById('kfcPopupText').innerHTML = popupTexts[mode];
            document.getElementById('kfcPopup').classList.add('show');
        }

        function closePopup() {
            document.getElementById('kfcPopup').classList.remove('show');
            showKfcUI();
        }

        function closePopupAndCopy() {
            document.getElementById('kfcPopup').classList.remove('show');
            showKfcUI();
            copyKfcText();
        }

        function showKfcUI() {
            const mode = currentMode;
            const kfcMsg = document.getElementById(mode + 'KfcMsg');
            const copyBtn = document.getElementById(mode + 'CopyBtn');
            if (kfcMsg) kfcMsg.classList.add('show');
            if (copyBtn) copyBtn.classList.add('show');
        }

        function copyKfcText() {
            if (!currentKfcText) {
                currentKfcText = getRandomKfcText();
            }

            if (navigator.clipboard) {
                navigator.clipboard.writeText(currentKfcText).then(() => {
                    showToast('å¤åˆ¶æˆåŠŸï¼å¿«å»å¥—è·¯æœ‹å‹~');
                }).catch(() => fallbackCopy());
            } else {
                fallbackCopy();
            }
        }

        function fallbackCopy() {
            const ta = document.createElement('textarea');
            ta.value = currentKfcText;
            ta.style.position = 'fixed';
            ta.style.opacity = '0';
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            showToast('å¤åˆ¶æˆåŠŸï¼å¿«å»å¥—è·¯æœ‹å‹~');
        }
    </script>
</body>
</html>
